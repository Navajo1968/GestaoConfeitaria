"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_document-metadata_document-metadata_ts-ui_packages_custom-copilots_components_Cus-bfb1df"],{78904:(e,t,a)=>{a.d(t,{T:()=>d});var r=a(17908),n=a(5796),i=a(46584),l=a(70404),s=a(57572),o=a(96540),c=a(46636);function d(){let{sendAnalyticsEvent:e}=(0,l.s)(),t=function(){let e=function(){let e=(0,r.t)(),t=(0,c.i)();return(0,o.useMemo)(()=>({react_app:"code-view",repository_id:e.id,repository_nwo:`${e.ownerLogin}/${e.name}`,repository_public:e.public,repository_is_fork:e.isFork,actor_id:t?.id,actor_login:t?.login}),[e,t])}(),t=(0,r.t)(),a=(0,n.yH8)(n.tTz,{owner:t.ownerLogin,repo:t.name});return(0,o.useCallback)((t,r,n)=>{let i={target:t,interaction:r,context:n,...e,url:window.location.href,user_agent:window.navigator.userAgent,browser_width:window.innerWidth,browser_languages:window.navigator.languages.join(",")};(0,s.lS)(a,{method:"POST",body:i})},[e,a])}(),a=(0,i.u)("code_nav_ui_events");return{sendRepoClickEvent:(0,o.useCallback)((r,n={})=>{e("repository.click",r,n),a&&t(r,"click",n)},[e,t,a]),sendRepoKeyDownEvent:(0,o.useCallback)((r,n={})=>{e("repository.keydown",r,n),a&&t(r,"keydown",n)},[e,t,a]),sendStats:(0,o.useCallback)((r,n={})=>{e(r,"",n),a&&t(r,"stats",n)},[e,t,a]),sendMarketplaceActionEvent:(0,o.useCallback)((t,a={})=>{e("marketplace.action.click",t,a)},[e])}}},83023:(e,t,a)=>{a.d(t,{o:()=>u});var r=a(5225),n=a(17908),i=a(5796),l=a(57572),s=a(96540);async function o(e){let t=await (0,l.lS)(e);return t.ok?await t.json():void 0}let c=new Map,d=(0,r.A)(o,{cache:c});function u(e,t,a){let r=(0,n.t)(),[l,o]=(0,s.useState)({list:[],directories:[],loading:!0}),c=(0,i.ClY)({repo:r,commitOid:e,includeDirectories:!a});return(0,s.useEffect)(()=>{let e=!1,a=async()=>{o({list:[],directories:[],loading:!0});let t=await d(c);if(e)return;let a=t?.paths||[],r=t?.directories||[];o({list:a.concat(r).sort(),directories:r,error:!t})};return t&&a(),function(){e=!0}},[c,t,a]),l}},38556:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(14194),n=a(17908),i=a(5796),l=a(94232),s=a(96540);function o(){let e=(0,n.t)(),{path:t,action:a,refInfo:o}=(0,r.eu)(),[c]=(0,l.I)(()=>!1,!0,[]);function d(e){return e?`?${e}`:""}function u(e){return c?"":void 0===e?window.location.hash:e?`#${e}`:""}return{getItemUrl:s.useCallback(t=>(0,i.IO9)({repo:e,commitish:o.name,action:"directory"===t.contentType?"tree":"blob",path:t.path}),[e.ownerLogin,e.name,o.name]),getUrl(r={}){let n=(0,i.IO9)({repo:e,commitish:r.commitish||o.name,action:r.action||a,path:r.path||t})+function({params:e,hash:t}){return d(e)+u(t)}(r);return r.absolute?new URL(n,window.location.origin).href:n},createPermalink(r={}){let n=(0,i.IO9)({repo:e,commitish:o.currentOid,action:r.action||a,path:r.path||t})+function({params:e,hash:t}){return d(e)+u(t)}(r);return r.absolute?new URL(n,window.location.origin).href:n},isCurrentPagePermalink:()=>!c&&o.name===o.currentOid&&window.location.pathname.includes(o.currentOid)}}},73412:(e,t,a)=>{a.d(t,{z:()=>WebWorker});var r=a(75632);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let WebWorker=class WebWorker{set onmessage(e){this.worker.onmessage=e}postMessage(e){this.worker.postMessage(e)}terminate(){this.worker.terminate()}constructor(e,t){n(this,"worker",void 0);try{let t=(0,r.G7)("module_workers");this.worker=new Worker(t?`${e}?module=true`:e,t?{type:"module"}:void 0)}catch{console.warn("Web workers are not available. Please enable web workers to benefit from the improved performance."),this.worker=new MainThreadWorker(t)}}};let MainThreadWorker=class MainThreadWorker{async postMessage(e){if(this.terminated)return;let t={data:this.job({data:e})};this.onmessage?.(t)}terminate(){this.terminated=!0}constructor(e){n(this,"terminated",!1),n(this,"onmessage",void 0),this.job=e}}},7911:(e,t,a)=>{a.d(t,{j:()=>l});var r=a(5225),n=a(91385);let i=(0,r.A)(n.fN);function l({data:e}){let{query:t,baseList:a,startTime:r}=e,l=t.replaceAll("\\","");return{query:t,list:a.filter(e=>""===l||(0,n.qA)(l,e)&&i(l,e)>0).sort((e,t)=>i(l,t)-i(l,e)),baseCount:a.length,startTime:r}}},2640:(e,t,a)=>{a.d(t,{D:()=>i,Y:()=>l});var r=a(13080),n=a(47584);function i(e){if(!n.XC)return;let t=n.XC.querySelector("title"),a=n.XC.createElement("title");a.textContent=e,t?t.textContent!==e&&(t.replaceWith(a),(0,r.i)(e)):(n.XC.head.appendChild(a),(0,r.i)(e))}function l(e){return document.body.classList.contains("logged-out")?`${e} \xb7 GitHub`:e}},70404:(e,t,a)=>{a.d(t,{S:()=>o,s:()=>s});var r=a(21728),n=a(96540),i=a(46988),l=a(50045);function s(){let e,t;let a=(0,r.c)(6),s=(0,n.useContext)(l.I);if(!s)throw Error("useAnalytics must be used within an AnalyticsContext");let{appName:o,category:c,metadata:d}=s;a[0]!==o||a[1]!==c||a[2]!==d?(e=(e,t,a)=>{let r={react:!0,app_name:o,category:c,...d};(0,i.BI)(e,{...r,...void 0===a?{}:a,target:t})},a[0]=o,a[1]=c,a[2]=d,a[3]=e):e=a[3];let u=e;return a[4]!==u?(t={sendAnalyticsEvent:u},a[4]=u,a[5]=t):t=a[5],t}function o(){let e,t;let a=(0,r.c)(4),{sendAnalyticsEvent:n}=s();a[0]!==n?(e=e=>{n("analytics.click",void 0,void 0===e?{}:e)},a[0]=n,a[1]=e):e=a[1];let i=e;return a[2]!==i?(t={sendClickAnalyticsEvent:i},a[2]=i,a[3]=t):t=a[3],t}},28448:(e,t,a)=>{a.d(t,{Z:()=>n});var r=a(96540);function n({focusRowRef:e,mouseRowRef:t}){let[a,n]=r.useState(!1);return r.useEffect(()=>{if(e.current&&t.current){let a=()=>{let t=e.current?.querySelector(".PRIVATE_TreeView-item-content-text");t?.scrollWidth!==t?.offsetWidth&&n(!0)};e.current.onfocus=()=>{a()},e.current.onblur=()=>{n(!1)},t.current.onmouseenter=()=>{a()},t.current.onmouseleave=()=>{n(!1)}}},[e,t]),a}},6262:(e,t,a)=>{a.d(t,{E:()=>i});var r=a(74848),n=a(69197);function i({children:e}){return(0,n.P)()?(0,r.jsx)(r.Fragment,{children:e}):null}try{i.displayName||(i.displayName="AllShortcutsEnabled")}catch{}},69197:(e,t,a)=>{a.d(t,{$:()=>l,P:()=>s});var r=a(74848),n=a(96540);let i=n.createContext(!0);function l({allShortcutsEnabled:e,children:t}){return(0,r.jsxs)(i.Provider,{value:e,children:[" ",t," "]})}function s(){return n.useContext(i)}try{i.displayName||(i.displayName="AllShortcutsEnabledContext")}catch{}try{l.displayName||(l.displayName="AllShortcutsEnabledProvider")}catch{}},23832:(e,t,a)=>{a.d(t,{Ck:()=>s,JS:()=>l});var r=a(74848),n=a(96540);let i=(0,n.createContext)({query:"",setQuery:()=>void 0});function l(){return(0,n.useContext)(i)}function s({children:e}){let[t,a]=(0,n.useState)(""),l=(0,n.useMemo)(()=>({query:t,setQuery:a}),[a,t]);return(0,r.jsx)(i.Provider,{value:l,children:e})}try{i.displayName||(i.displayName="FileQueryContext")}catch{}try{s.displayName||(s.displayName="FileQueryProvider")}catch{}},14194:(e,t,a)=>{a.d(t,{eu:()=>o,qV:()=>s,sq:()=>c});var r=a(74848),n=a(38359),i=a(96540);let l=i.createContext({});function s({children:e,...t}){return(0,r.jsx)(l.Provider,{value:t,children:e})}function o(){return i.useContext(l)}function c(){return(0,n.X)()}try{l.displayName||(l.displayName="FilesPageInfoContext")}catch{}try{s.displayName||(s.displayName="FilesPageInfoProvider")}catch{}},17908:(e,t,a)=>{a.d(t,{d:()=>l,t:()=>s});var r=a(74848),n=a(96540);let i=n.createContext({});function l({repository:e,children:t}){return(0,r.jsxs)(i.Provider,{value:e,children:[" ",t," "]})}function s(){return n.useContext(i)}try{i.displayName||(i.displayName="CurrentRepositoryContext")}catch{}try{l.displayName||(l.displayName="CurrentRepositoryProvider")}catch{}},46636:(e,t,a)=>{a.d(t,{Q:()=>l,i:()=>s});var r=a(74848),n=a(96540);let i=n.createContext(void 0);function l({user:e,children:t}){return(0,r.jsxs)(i.Provider,{value:e,children:[" ",t," "]})}function s(){return n.useContext(i)}try{i.displayName||(i.displayName="CurrentUserContext")}catch{}try{l.displayName||(l.displayName="CurrentUserProvider")}catch{}},23343:(e,t,a)=>{a.d(t,{S:()=>eR});var r=a(74848),n=a(31655),i=a(73451),l=a(67138),s=a(51856),o=a(6020),c=a(87330),d=a(55847),u=a(30631),m=a(37827),h=a(56221),p=a(38621),f=a(57572),x=a(96540),y=a(53949),g=a(70642),j=a(82610),b=a(26556),v=a(17908),C=a(23832),w=a(14194),S=a(78904),k=a(83023),I=a(38556),N=a(73412),A=a(7911),R=a(69252),E=a(5796),F=a(17774),T=a(41980),_=a(46928),P=a(69676),O=a(82678),L=a(75177),$=a(65481),D=a(8338),G=a(34614),W=a(85349),V=a(63867),M=a(30729),z=a(91385),U=a(70170),q=a(6262),H=a(47584);let Q=x.forwardRef(({ariaActiveDescendant:e,ariaControls:t,ariaExpanded:a,ariaHasPopup:n,onBlur:i,onFocus:s,onKeyDown:o,onPreload:c,onSearch:d,query:u,searchPlaceholder:m,sx:h},f)=>{let{sendRepoClickEvent:y}=(0,S.T)(),[g,j]=x.useState(u),b=x.useRef((0,U.s)(e=>d(e),250));x.useEffect(()=>{j(u)},[u]);let v=u?(0,r.jsx)(l.A.Action,{onClick:()=>{y("FILE_TREE.CANCEL_SEARCH"),d("")},icon:p.XCircleFillIcon,"aria-label":"Clear",className:"fgColor-muted"}):void 0;return(0,r.jsx)(l.A,{autoFocus:K(),ref:f,value:g,onKeyDown:o,onChange:e=>{j(e.target.value),c(),b.current(e.target.value)},sx:{display:"flex",...h},"aria-label":m||"Go to file","aria-activedescendant":e,role:n?"combobox":void 0,"aria-controls":t,"aria-expanded":a,"aria-haspopup":n?"dialog":void 0,autoCorrect:"off",spellCheck:"false",placeholder:m||"Go to file",leadingVisual:p.SearchIcon,trailingAction:v,trailingVisual:v?void 0:()=>(0,r.jsx)(q.E,{children:(0,r.jsx)(L.A,{sx:{mr:"-6px"},children:(0,r.jsx)("kbd",{children:"t"})})}),onFocus:e=>{c(),e.target.select(),s?.(e)},onBlur:i,onClick:()=>y("FILE_TREE.SEARCH_BOX")})});function K(){return"1"===new URLSearchParams(H.fV.search).get("search")}Q.displayName="FilesSearchBox";let B={excludeDirectories:!1,excludeSeeAllResults:!1};function Y({actionListSx:e,additionalResults:t,commitOid:a,config:n=B,findFileWorkerPath:i,getItemUrl:l,onRenderRow:s,onItemSelected:o,searchBoxRef:c,sx:d}){let{excludeDirectories:u,excludeSeeAllResults:m}=n,{query:h,setQuery:p}=(0,C.JS)(),f=(0,v.t)(),y=x.useRef(null),g=c??y,[j,b]=x.useState(h.length>0),[F,V]=x.useState(!!h),{list:M,directories:z,loading:U,error:q}=(0,k.o)(a,j,!!u),{path:H}=(0,w.eu)(),{getUrl:Y}=(0,I.Z)(),{queryText:Z,queryLine:J}=function(e){let t=(e=e.replaceAll(" ","")).indexOf(":");return t>=0?{queryText:e.substring(0,t),queryLine:parseInt(e.substring(t+1),10)}:{queryText:e,queryLine:void 0}}(h),{matches:ee,clearMatches:ea}=function(e,t,a,r){let[n,i]=x.useState(),l=x.useRef(""),s=x.useRef(),{sendStats:o}=(0,S.T)(),c=x.useRef(!1),d=x.useCallback(()=>{let e=new N.z(a,A.j);e.onmessage=({data:e})=>{c.current=!1,i(e.list),l.current=e.query,e.startTime&&o("repository.find-file",{"find-file-base-count":e.baseCount,"find-file-results-count":e.list.length,"find-file-duration-ms":performance.now()-e.startTime})},s.current=e},[o,a]);return x.useEffect(()=>{if(r)return d(),function(){s.current?.terminate()}},[d,r]),x.useEffect(()=>{if(e.length&&t){c.current&&(s.current?.terminate(),d());let a=l.current&&t.startsWith(l.current);c.current=!0,s.current?.postMessage({baseList:a&&n||e,query:t,startTime:performance.now()})}},[e,t,d]),{matches:n,clearMatches:()=>i(void 0)}}((0,x.useMemo)(()=>[...M,...t??[]].sort(),[t,M]),Z,i,j),{sendRepoClickEvent:er}=(0,S.T)(),en=(0,_.Z)(),[ei,el]=x.useState(0),[es,eo]=x.useState(()=>K()),ec=x.useRef(null),ed=x.useRef(null),eu="file-results-list",{sendRepoKeyDownEvent:em}=(0,S.T)(),{screenSize:eh}=(0,T.lm)(),ep=n.enableOverlay??eh>=T.Gy.large,ef=x.useCallback(e=>{er("FILE_TREE.SEARCH_RESULT_CLICK"),o?.(e),V(!1)},[er,o]),ex=(e,t,a)=>l?l(e,t,a):Y({path:e,action:t?"tree":"blob",hash:a}),{containerRef:ey}=(0,O.G)({bindKeys:P.z0.ArrowVertical|P.z0.HomeAndEnd,focusInStrategy:"previous"},[U,q]);x.useEffect(()=>{h||V(!1)},[h]),x.useEffect(()=>{document.activeElement!==g.current&&ep&&V(!1)},[H,g,ep]);let eg=ee?.slice(0,40)||[],ej=ee&&ee.length>eg.length,eb=!n.disableNavigation,ev=(0,r.jsx)(L.A,{sx:{maxHeight:ep?"60vh":"100% !important",overflowY:"auto",scrollbarGutter:"stable",maxWidth:"100vw"},children:q?(0,r.jsx)($.A,{variant:"danger",className:"m-3",children:"Failed to search"}):(0,r.jsxs)(D.l,{ref:ey,sx:{overflow:"auto",p:ep?2:3,width:"100%",pr:ep?3:0,pt:ep?3:"2px !important",...e},role:"listbox",children:[!U&&eg.map((e,t)=>{let a=z.includes(e),i=ex(e,a,J?`L${J}`:"");return(0,r.jsx)(et,{active:e===H,index:t,focused:es&&ei===t,match:e,onRender:s,query:Z,onClick:ef,isDirectory:a,to:i,useOverlay:ep,listRef:ey,noAnchor:n.disableNavigation,actionText:n.actionText},e)}),(0,r.jsxs)("div",{className:"m-3 text-center",children:[(0,r.jsx)(X,{loading:U||!ee,visibleResultCount:eg.length,truncated:!!ej}),ej&&!m&&(0,r.jsxs)(r.Fragment,{children:["\xa0",(0,r.jsx)(G.A,{id:"see-all-results-link",className:"focus-visible",ref:ec,href:(0,E.Y8Y)({owner:f.ownerLogin,repo:f.name,searchTerm:`path:${Z}`}),sx:es&&ei===eg.length?{outline:"2px solid var(--focus-outlineColor, var(--color-accent-fg))",outlineOffset:"-2px",boxShadow:"none"}:{},children:"See all results"})]})]})]})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.A,{ref:ed,sx:{mx:2,...d},children:(0,r.jsx)(Q,{ariaActiveDescendant:(!ep&&h||ep&&F)&&es&&ei>-1?ej&&ei===eg.length?"see-all-results-link":`file-result-${ei}`:void 0,ariaExpanded:ep?F:void 0,ariaHasPopup:ep,ariaControls:ep?eu:void 0,ref:g,query:h,onKeyDown:e=>{let{key:t,shiftKey:a,metaKey:r,altKey:n,ctrlKey:i}=e;if(!a&&!r&&!n){if("Escape"===t)h?(em("FILE_TREE.CANCEL_SEARCH"),p(""),ea()):document.activeElement&&document.activeElement.blur();else if(!h)return;else if("Enter"===t){if(!m&&ej&&ei===eg.length)eb&&en((0,E.Y8Y)({owner:f.ownerLogin,repo:f.name,searchTerm:`path:${Z}`})),o?.();else if(eg[ei]){let e=eg[ei];eb&&en(ex(eg[ei],!1,J?`L${J}`:"")),V(!1),o?.(e)}}else if("ArrowDown"===t||i&&"n"===t){if(!m&&ej&&ei>=eg.length-1){if(el(eg.length),ec.current&&ey.current){let e=(0,R.U)(ey.current);(0,P.Rt)(ec.current,e,{behavior:"instant"})}}else el(Math.min(ei+1,eg.length-1));e.preventDefault();return}else if("ArrowUp"===t||i&&"p"===t){el(Math.max(ei-1,0)),e.preventDefault();return}}},onPreload:()=>b(!0),onSearch:e=>{p(e),e?V(!0):(ea(),V(!1)),el(0)},onBlur:e=>{ey.current?.contains(e.relatedTarget)||(V(!1),eo(!1))},onFocus:()=>{h&&V(!0),eo(!0)},searchPlaceholder:n.searchPlaceholder,sx:{minWidth:"160px"}})}),ep&&(0,r.jsx)(W.T,{anchorRef:ed,open:ep&&F,renderAnchor:null,onClose:()=>{V(!1)},focusZoneSettings:{disabled:!0},focusTrapSettings:{disabled:!0},width:"xlarge",align:"end",overlayProps:{id:eu,role:"dialog"},children:ev}),!ep&&h&&ev]})}function X({visibleResultCount:e,truncated:t,loading:a}){return(0,r.jsx)("span",{role:"status",className:a||t||0===e?void 0:"sr-only","aria-label":a?"Loading":void 0,children:a?(0,r.jsx)(V.A,{size:"large"}):0===e?"No matches found":t?`First ${e} files shown.`:`Showing ${e} files.`},"results-count-status")}let Z=({active:e,focused:t,index:a,match:n,query:i,to:l,isDirectory:s,onClick:o,onRender:c,useOverlay:d,listRef:u,noAnchor:m,actionText:h})=>{let p=(0,z.Xq)(i,n);c?.();let f=x.useRef(null);x.useEffect(()=>{if(t&&f.current&&u?.current){let e=(0,R.U)(u.current);(0,P.Rt)(f.current,e,{behavior:"instant"})}},[t,u]);let y={};t&&(y={outline:"none",border:"2 solid",boxShadow:"0 0 0 2px #0969da"});let g={id:`file-result-${a}`,active:e,onSelect:(0,x.useCallback)(()=>{o?.(n)},[n,o]),sx:{fontWeight:"normal",":hover":{textDecoration:"none"},mx:"2px",width:"calc(100% - 4px)",...y},role:"option","data-focus-visible-added":t||void 0,tabIndex:d?-1:0},j=(0,r.jsxs)("div",{className:"d-flex",children:[(0,r.jsx)("div",{className:"d-flex flex-1 flex-column overflow-hidden",children:(0,r.jsx)(ea,{text:n,positionsList:p,sx:{color:"fg.muted"},LeadingIcon:s?J:ee})}),t&&(0,r.jsx)(L.A,{sx:{pl:1,whiteSpace:"nowrap",color:"fg.muted"},children:m?h:`Go to ${s?"folder":"file"}`})]});return m?(0,x.createElement)(D.l.Item,{...g,key:n},j):(0,x.createElement)(D.l.Item,{...g,ref:f,as:F.N,to:l,key:n},j)},J=()=>(0,r.jsx)(M.A,{"aria-label":"Directory",icon:p.FileDirectoryFillIcon,sx:{color:"var(--treeViewItem-leadingVisual-iconColor-rest, var(--color-icon-directory))",mr:2},size:"small"}),ee=()=>(0,r.jsx)(M.A,{"aria-label":"File",icon:p.FileIcon,className:"fgColor-muted mr-2",size:"small"}),et=x.memo(Z);function ea({text:e,positionsList:t,sx:a,LeadingIcon:n}){let i=[],l=0;for(let a of t){if(Number(a)!==a||a<l||a>e.length)continue;let t=e.slice(l,a);t&&i.push(er(t)),l=a+1,i.push((0,r.jsx)("mark",{className:"text-bold bgColor-transparent fgColor-default",children:e[a]},a))}return i.push(er(e.slice(l))),(0,r.jsx)(L.A,{sx:a,children:(0,r.jsxs)(r.Fragment,{children:[n&&(0,r.jsx)(n,{}),i]})})}function er(e){return e.replaceAll("/","/\u200B")}try{Y.displayName||(Y.displayName="FileResultsList")}catch{}try{X.displayName||(X.displayName="FileResultsStatus")}catch{}try{Z.displayName||(Z.displayName="FileResultRow")}catch{}try{J.displayName||(J.displayName="DirectoryIcon")}catch{}try{ee.displayName||(ee.displayName="FileResultIcon")}catch{}try{et.displayName||(et.displayName="MemoizedFileResultRow")}catch{}try{ea.displayName||(ea.displayName="HighlightMatch")}catch{}function en({formData:e,onCancel:t,onSave:a,findFileWorkerPath:n}){let[s,o]=(0,x.useState)(null),[c,u]=(0,x.useState)({}),[m,h]=(0,x.useState)(null),[g,j]=(0,x.useState)(null),[S,k]=(0,x.useState)(e),I=async e=>{let t;if(c[e]){j(t=c[e]);return}try{let a=await (0,f.lS)(`/github-copilot/chat/repositories/${e}`,{method:"GET"});if(!a.ok){h(`Failed to fetch repository details: ${a.status}`);return}t=await a.json(),u(a=>({...a,[e]:t})),j(t)}catch(e){h(e instanceof Error?e.message:"An unknown error occurred")}};async function N(e){let t=await (0,f.lS)(`/_filter/repositories?q=${encodeURIComponent(e)}`);return t.ok?(await t.json()).repositories.map(e=>({name:e.nameWithOwner,enabled:!0,id:e.id})):[]}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Q,{leadingVisual:p.ArrowLeftIcon,variant:"invisible",onClick:t,children:"Back"}),(0,r.jsxs)("div",{className:"d-flex flex-column gap-3 p-3",children:[s&&(0,r.jsx)("span",{children:s}),m&&(0,r.jsx)("span",{children:m}),(0,r.jsx)("h1",{className:"f3",children:"New GitHub File"}),(0,r.jsx)("div",{children:(0,r.jsx)(b.P,{repositoryLoader:N,selectionVariant:"single",selectAllOption:!1,currentSelection:void 0,onSelect:e=>{e&&(k({...S,repositoryId:e.id,nwo:e.name}),I(e.id))},buttonText:S.nwo||"Select repository"})}),g&&(0,r.jsx)(v.d,{repository:g,children:(0,r.jsx)(C.Ck,{children:(0,r.jsxs)(w.qV,{refInfo:{name:g.refInfo.name,canEdit:!0,listCacheKey:"anything",currentOid:g.commitOID},path:"test",action:"tree",copilotAccessAllowed:!0,children:[(0,r.jsxs)(i.A,{children:[(0,r.jsx)(i.A.Label,{children:"File path"}),(0,r.jsx)(l.A,{block:!0,value:S.filePath||"",onChange:e=>{k({...S,filePath:e.target.value})},...(0,y.G)("resource-file-path-input")})]}),(0,r.jsx)(Y,{commitOid:g.commitOID,findFileWorkerPath:n,onItemSelected:e=>{k({...S,filePath:e||""})},config:{enableOverlay:!0,disableNavigation:!0,searchPlaceholder:"Select a file",actionText:"Select a file"},sx:{mr:1,ml:1}})]})})}),(0,r.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[(0,r.jsx)(d.Q,{onClick:t,children:"Cancel"}),(0,r.jsx)(d.Q,{...(0,y.G)("save-resource-button"),variant:"primary",onClick:()=>{let e=S.repositoryId,t=S.nwo;e&&t?a([S]):o("You must select a repository")},children:"Save"})]})]})]})}try{en.displayName||(en.displayName="GitHubFileForm")}catch{}var ei=a(91246),el=a(7284),es=a(28448),eo=a(94227),ec=a(65607),ed=a(65556);function eu(e,t,a){let r=[];for(let n of t)if(n.startsWith(e)){let t=n.slice(e.length+1),i=t.indexOf("/"),l=i>0?t.slice(0,i):t,s=`${e}/${l}`;if(a&&a.some(e=>e.path===s))continue;let o={items:[],data:{contentType:s===n?"file":"directory",name:l,path:s,isClientOnly:!0}};r.push(o)}return r}let em={checkbox:"FileTreePicker-module__checkbox--xtwO6",itemContainer:"FileTreePicker-module__itemContainer--yiAEi"};function eh(e,t){let a=new Set(e);switch(t.type){case"SELECT_FILE":a.add(t.path);break;case"DESELECT_FILE":a.delete(t.path);break;case"SELECT_DIRECTORY":for(let e of t.paths)a.add(e);break;case"DESELECT_DIRECTORY":for(let e of t.paths)a.delete(e)}return a}function ep({isActive:e,file:t,onItemSelected:a,getItemUrl:n,selectedItemRef:i,navigate:l,onRenderRow:s,getFileTrailingVisual:o,getFileIcon:c,navigateOnClick:d,isSelected:u}){let{sendRepoClickEvent:m}=(0,S.T)(),h=x.useRef(null),f=(0,es.Z)({focusRowRef:h,mouseRowRef:h}),y="submodule"===t.data.contentType,g=o?.(t.data);(0,x.useEffect)(()=>{e&&h.current&&requestAnimationFrame(()=>{h.current?.scrollIntoView({block:"center"})})},[e]);let j=x.useCallback(e=>{y?(e.preventDefault(),t.data.submoduleUrl&&(window.location.href=t.data.submoduleUrl)):e.metaKey||e.ctrlKey||1===e.button?(window.open(n(t.data),"_blank"),e.preventDefault()):(a?.(t.data,t),m("FILES_TREE.ITEM",{item_path:t.data.path}),d&&l(n(t.data)),e.stopPropagation())},[t,n,y,l,d,a,m]);return s?.(),(0,r.jsxs)(eo.G.Item,{ref:h,onSelect:j,current:e,id:`${t.data.path}-item`,containIntrinsicSize:e?void 0:"auto 2rem",children:[(0,r.jsx)(eo.G.LeadingVisual,{children:c?c(t.data):y?(0,r.jsx)(p.FileSubmoduleIcon,{}):(0,r.jsx)(p.FileIcon,{})}),(0,r.jsxs)("div",{className:em.itemContainer,children:[(0,r.jsx)(ec.A,{className:em.checkbox,checked:u||!1,readOnly:!0,"aria-label":`Select ${t.data.name}`}),(0,r.jsx)("span",{ref:i,style:{color:y?"var(--fgColor-accent, var(--color-accent-fg))":void 0},children:(0,r.jsx)("span",{"data-testid":`${t.data.path}-file-item`,children:t.data.name})})]}),f&&(0,r.jsx)(el.m,{"data-testid":`${t.data.name}-item-tooltip`,id:`${t.data.name}-item-tooltip`,contentRef:h,"aria-label":t.data.name,open:!0,direction:"ne"}),!!g?.screenReaderText&&(0,r.jsx)("span",{className:"sr-only",children:g.screenReaderText}),!!g?.trailingVisual&&(0,r.jsx)(eo.G.TrailingVisual,{children:g.trailingVisual})]})}let ef=x.memo(ep),ex=x.memo(ec.A);function ey({clientOnlyFilePaths:e,directory:t,isActive:a,isAncestorOfActive:n,leadingPath:i,onItemSelected:l,getItemUrl:s,getFetchUrl:o,selectedItemRef:c,navigate:d,onRenderRow:u,getFileTrailingVisual:m,getFileIcon:h,navigateOnClick:p,selectedChildren:y,expandedPath:g}){let[j,b]=(0,x.useState)(n),{sendRepoClickEvent:v}=(0,S.T)(),C=x.useRef(null),w=x.useRef(null),k=(0,es.Z)({focusRowRef:w,mouseRowRef:C}),I=x.useMemo(()=>y?.filter(e=>e.startsWith(`${t.data.path}/`)),[y,t.data.path]),N=x.useMemo(()=>(function(e,t){if(!t||0===t.length)return"none";if(t.includes(e.data.path))return"all";let a=e.data.totalCount||0,r=t.filter(t=>t.startsWith(`${e.data.path}/`)).length;return 0===r?"none":r===a?"all":"partial"})(t,y),[t,y]),[A,R,E,F,T,_,P]=function(e,t,a){let[r,n]=x.useState(e.items),[i,l]=x.useState(e.data.totalCount||0),[s,o]=x.useState(!1),[c,d]=x.useState(!1),{safeSetTimeout:u}=(0,ed.A)();x.useEffect(()=>{n(e.items)},[e.items]),x.useEffect(()=>{void 0!==e.data.totalCount&&l(e.data.totalCount)},[e.data.totalCount]);let m=x.useCallback(()=>{d(!1)},[]),h=x.useCallback((e,t)=>{let a=e||[...r];n(a.slice(0,100)),u(()=>{n(a),void 0!==t&&l(t)},1)},[r,u]);return[x.useCallback(async r=>{let i=new Map;if(e.data.isClientOnly){if(r){let a=eu(e.data.path,r);for(let e of a)i.set(e.data.path,e);t({type:"add",folders:i,processingTime:0}),a.length>100?h(a,a.length):(n(a),l(a.length))}}else{let s=a(e.data);d(!1),o(!0);let c=Date.now(),u=await (0,f.lS)(`${s}?noancestors=1`);try{if(u.ok){let a=await u.json(),s=a.payload.tree.items.map(e=>{let t={items:[],data:{...e},autoExpand:"directory"===e.contentType&&1===a.payload.tree.items.length};return(i.set(e.path,t),e.hasSimplifiedPath)?function e(t,a,r){t.data.name=t.data.name.slice(t.data.name.lastIndexOf("/")+1,t.data.name.length);let n=a.name.slice(0,a.name.lastIndexOf("/")),i=n.indexOf("/")>-1,l={path:a.path.slice(0,a.path.lastIndexOf("/")),contentType:a.contentType,name:n,hasSimplifiedPath:i},s={items:[t],data:l};return(r.set(l.path,s),i)?e(s,{...l},r):s}(t,e,i):t});if(r){let t=e.data.path,n=eu(t,r,a.payload.tree.items);for(let e of(s.push(...n),n))i.set(e.data.path,e)}t({type:"add",folders:i,processingTime:Date.now()-c}),e.items=s,e.data.totalCount=a.payload.tree.totalCount,s.length>100?h(s,a.payload.tree.totalCount):(n(s),l(a.payload.tree.totalCount))}else d(!0)}catch{d(!0)}}o(!1)},[a,e,t,h]),h,r,s,c,m,i]}(t,()=>{},o),O=i?`${i}/`:"",L=P-E.length;(0,x.useEffect)(()=>{a&&C.current&&requestAnimationFrame(()=>{C.current?.scrollIntoView({block:"center"})})},[a]);let $=x.useCallback(e=>{!e||j||F||T||!(t.items.length>100)||R(),e!==j&&b(e)},[j,F,T,t.items.length,R]),D=x.useCallback(e=>{e.metaKey||e.ctrlKey||1===e.button&&p?(window.open(s(t.data),"_blank"),e.preventDefault()):(l?.(t.data,t),v("FILES_TREE.ITEM",{item_path:t.data.path}),p&&d(s(t.data)),e.stopPropagation())},[t,s,d,p,l,v]);x.useEffect(()=>{n&&!j&&$?.(!0)},[n]),x.useEffect(()=>{0===t.items.length&&j?$?.(!1):!j&&t.autoExpand&&$?.(!0)},[t.items.length]);let G=x.useCallback(e=>{c&&a&&c(e),C.current=e},[c,a]);if(1===t.items.length){let n=t.items[0];if(n&&"directory"===n.data.contentType)return(0,r.jsx)(eb,{clientOnlyFilePaths:e,directoryItems:t.items,leadingPath:O+t.data.name,inheritsActive:a,onItemSelected:l,selectedItemRef:c,getItemUrl:s,directoryNavigateOnClick:p,navigateOnClick:p,getFileTrailingVisual:m,getFileIcon:h,selectedChildren:I,expandedPath:g})}return u?.(),(0,r.jsxs)(eo.G.Item,{ref:w,expanded:j,onExpandedChange:$,current:a,onSelect:D,id:`${t.data.path}-item`,containIntrinsicSize:a?void 0:"auto 2rem",children:[(0,r.jsx)(eo.G.LeadingVisual,{children:(0,r.jsx)(eo.G.DirectoryIcon,{})}),(0,r.jsxs)("div",{className:em.itemContainer,children:[(0,r.jsx)(ex,{className:em.checkbox,checked:"all"===N,indeterminate:"partial"===N,readOnly:!0,"aria-label":`Select ${t.data.name}`,"data-indeterminate":"partial"===N?"true":void 0}),(0,r.jsxs)("span",{ref:G,children:[O&&(0,r.jsx)("span",{children:O}),(0,r.jsx)("span",{"data-testid":`${t.data.path}-directory-item`,children:t.data.name})]})]}),k&&(0,r.jsx)(el.m,{"data-testid":`${t.data.name}-directory-item-tooltip`,id:`${t.data.name}-directory-item-tooltip`,contentRef:w,"aria-label":`${O}${t.data.name}`,open:!0,direction:"ne"}),(0,r.jsx)(eo.G.SubTree,{state:F?"loading":T?"error":"done",children:T?(0,r.jsx)(eo.G.ErrorDialog,{onRetry:A,onDismiss:_,children:"There was an error loading the folder contents."}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eb,{clientOnlyFilePaths:e,directoryItems:E,onItemSelected:l,selectedItemRef:c,getItemUrl:s,directoryNavigateOnClick:p,navigateOnClick:p,getFileTrailingVisual:m,getFileIcon:h,selectedChildren:I,expandedPath:g}),L>0&&(0,r.jsx)(eC,{message:`${L} entries not shown`})]})})]})}let eg=x.memo(ey,(e,t)=>e.isActive===t.isActive&&e.isAncestorOfActive===t.isAncestorOfActive&&e.directory===t.directory&&(e.selectedChildren===t.selectedChildren||0===e.selectedChildren.length&&0===t.selectedChildren.length)&&e.expandedPath===t.expandedPath);function ej({clientOnlyFilePaths:e,directoryItems:t,leadingPath:a,inheritsActive:n,onItemSelected:i,selectedItemRef:l,onRenderRow:s,getItemUrl:o,getFileTrailingVisual:c,getFileIcon:d,directoryNavigateOnClick:u,navigateOnClick:m,selectedChildren:h,expandedPath:p}){let f=(0,I.Z)(),y=(0,_.Z)(),g=x.useRef(y),j=x.useRef(i);x.useEffect(()=>{j.current=i,g.current=y},[i,y]);let b=x.useCallback((e,t)=>{j.current?.(e,t)},[]),v=x.useMemo(()=>t.map(t=>{let i=p===t.data.path,x=h?.includes(t.data.path),g=i||p.startsWith(`${t.data.path}/`),j=h?.filter(e=>e===t.data.path||e.startsWith(`${t.data.path}/`));return"directory"===t.data.contentType?(0,r.jsx)(eg,{clientOnlyFilePaths:e,isActive:n||i,isAncestorOfActive:g,onItemSelected:b,leadingPath:a,directory:t,getItemUrl:o,getFetchUrl:f.getItemUrl,selectedItemRef:g?l:void 0,navigate:y,onRenderRow:s,navigateOnClick:u,getFileTrailingVisual:c,getFileIcon:d,itemCount:t.items.length,isSelected:x,selectedChildren:j,expandedPath:p},t.data.name):(0,r.jsx)(ef,{onItemSelected:b,file:t,isActive:i,getItemUrl:o,selectedItemRef:i?l:void 0,navigate:y,navigateOnClick:m,onRenderRow:s,getFileTrailingVisual:c,getFileIcon:d,isSelected:x},t.data.name)}),[t,p,h,e,n,b,a,o,f.getItemUrl,l,y,s,u,c,d,m]);return(0,r.jsx)(r.Fragment,{children:v})}let eb=x.memo(ej);function ev(e){let{clientOnlyFilePaths:t,rootItems:a,fetchError:n,loading:i,onRenderRow:l,getItemUrl:s,getFileTrailingVisual:o,getFileIcon:c,expandedPath:d,onSelectionChange:u}=e,[m,h]=(0,x.useReducer)(eh,new Set),p=e.selectedItems||m,f=(0,x.useCallback)(e=>{let t=new Set;if(t.add(e.data.path),"directory"===e.data.contentType)for(let a of e.items)for(let e of f(a))t.add(e);return Array.from(t)},[]),y=(0,x.useCallback)((e,t)=>{let a=t?{type:"DESELECT_FILE",path:e}:{type:"SELECT_FILE",path:e};u?u(eh(p,a)):h(a)},[u,p]),g=(0,x.useCallback)((e,t)=>{let a=f(e),r=t?{type:"DESELECT_DIRECTORY",paths:a}:{type:"SELECT_DIRECTORY",paths:a};u?u(eh(p,r)):h(r)},[f,u,p]),j=(0,x.useCallback)((e,t)=>{if("directory"===e.contentType){let e=f(t).every(e=>p.has(e));g(t,e)}else y(e.path,p.has(e.path))},[f,g,y,p]),b=(0,x.useCallback)(e=>{1===e.button&&e.preventDefault()},[]);return(0,r.jsx)(L.A,{onMouseDown:b,sx:{px:3,pb:2,...e.sx},"data-testid":"repos-file-tree-container",children:i?(0,r.jsx)(L.A,{sx:{display:"flex",justifyContent:"center",p:2},children:(0,r.jsx)(V.A,{"aria-label":"Loading file tree"})}):(0,r.jsx)("nav",{"aria-label":"File Tree Navigation",children:(0,r.jsxs)(eo.G,{"aria-label":"Files",children:[n&&(0,r.jsx)(eC,{message:"Some files could not be loaded."}),(0,r.jsx)(eb,{clientOnlyFilePaths:t,directoryItems:a,onItemSelected:j,selectedChildren:p?Array.from(p):[],selectedItemRef:e.selectedItemRef,onRenderRow:l,directoryNavigateOnClick:e.directoryNavigateOnClick,navigateOnClick:e.navigateOnClick,getItemUrl:s,getFileTrailingVisual:o,getFileIcon:c,expandedPath:d})]})})})}function eC({message:e}){return(0,r.jsxs)(eo.G.Item,{id:"error-tree-row",children:[(0,r.jsx)(eo.G.LeadingVisual,{children:(0,r.jsx)(M.A,{icon:p.AlertFillIcon,sx:{color:"attention.fg"}})}),(0,r.jsx)(L.A,{sx:{color:"fg.muted"},children:e||"Couldn't load."})]})}try{ep.displayName||(ep.displayName="WrappedFileTreeRow")}catch{}try{ef.displayName||(ef.displayName="FileTreeRow")}catch{}try{ex.displayName||(ex.displayName="MemoizedCheckbox")}catch{}try{ey.displayName||(ey.displayName="WrappedDirectoryTreeRow")}catch{}try{eg.displayName||(eg.displayName="DirectoryTreeRow")}catch{}try{ej.displayName||(ej.displayName="WrappedDirectoryContents")}catch{}try{eb.displayName||(eb.displayName="DirectoryContents")}catch{}try{ev.displayName||(ev.displayName="FileTreePicker")}catch{}try{eC.displayName||(eC.displayName="ErrorTreeRow")}catch{}var ew=a(69197);function eS({currentRepo:e,setLocalFormData:t,fetchError:a,onFileCountChange:n,processingTime:i,expandedPath:l}){let[s,o]=(0,x.useState)(new Set),[c,d]=(0,x.useState)(new Set),{list:u,directories:m,loading:h}=(0,k.o)(e.commitOID,!0),[p,f]=(0,x.useState)([]);(0,x.useEffect)(()=>{f(function e(t,a){let r=t[a];return r?r.items.map(a=>({data:a,items:"directory"===a.contentType?e(t,a.path):[]})).sort((e,t)=>"directory"===e.data.contentType&&"directory"!==t.data.contentType?-1:"directory"!==e.data.contentType&&"directory"===t.data.contentType?1:e.data.name.localeCompare(t.data.name)):[]}(function(e){let{paths:t,directories:a}=e,r={},n=new Set(a);for(let e of(r[""]={items:[],totalCount:0},[...a].sort())){let t=e.substring(0,e.lastIndexOf("/"))||"",a={name:e.substring(e.lastIndexOf("/")+1),path:e,contentType:"directory"};r[t]||(r[t]={items:[],totalCount:0}),r[t].items.push(a),r[e]||(r[e]={items:[],totalCount:0})}for(let e of t.filter(e=>!n.has(e)).sort()){let t=e.substring(0,e.lastIndexOf("/"))||"",a={name:e.substring(e.lastIndexOf("/")+1),path:e,contentType:"file"};r[t]||(r[t]={items:[],totalCount:0}),r[t].items.push(a)}for(let e in r){let t=r[e];t&&t.items.sort((e,t)=>"directory"===e.contentType&&"directory"!==t.contentType?-1:"directory"!==e.contentType&&"directory"===t.contentType?1:e.name.localeCompare(t.name))}let i=e=>{let t=r[e];return t?t.items.reduce((e,t)=>"directory"===t.contentType?e+1+i(t.path):e+1,0):0};for(let e in r){let t=r[e];t&&(t.totalCount=i(e))}return r}({paths:u,directories:m}),"")),d(new Set(m))},[u,m,f,e.commitOID]),(0,x.useEffect)(()=>{let a=Array.from(s).filter(e=>!c.has(e));n?.(a.length),t(a.map(t=>({id:`${e.id}-${t}`,repositoryId:e.id,nwo:`${e.ownerLogin}/${e.name}`,filePath:t,type:"github_file"})))},[s,c,e,t,n]);let y=(0,x.useCallback)(t=>`/${e.name}/${e.ownerLogin}/tree/${e.refInfo.name}/${t.path}`,[e]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(L.A,{sx:{flexGrow:1,width:"400px",maxHeight:"100% !important",minHeight:"300px",overflowY:"auto",scrollbarGutter:"stable"},children:(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"react-tree-show-tree-items",children:(0,r.jsx)(ev,{rootItems:p,expandedPath:l,selectedItemRef:()=>{},setRootItems:f,navigateOnClick:!1,directoryNavigateOnClick:!1,selectedItems:s,onSelectionChange:o,processingTime:i,loading:h||!1,fetchError:!!a,getItemUrl:y,sortDirectoryItems:e=>e.sort((e,t)=>e.data.name.localeCompare(t.data.name))})})})})})}function ek({onClose:e}){return(0,r.jsx)(c.K,{unsafeDisableTooltip:!0,icon:p.XIcon,"aria-label":"Close",onClick:e,variant:"invisible"})}function eI({formData:e,onCancel:t,onSave:a,findFileWorkerPath:n}){let[l,s]=(0,x.useState)({}),[o,c]=(0,x.useState)(null),[u,m]=(0,x.useState)(null),[h,p]=(0,x.useState)(e),[g]=(0,x.useState)(0),[j,S]=(0,x.useState)(""),[k,I]=(0,x.useState)(0),N=async e=>{let t;if(l[e]){m(t=l[e]);return}try{let a=await (0,f.lS)(`/github-copilot/chat/repositories/${e}`,{method:"GET"});if(!a.ok){c(`Failed to fetch repository details: ${a.status}`);return}t=await a.json(),s(a=>({...a,[e]:t})),m(t)}catch(e){c(e instanceof Error?e.message:"An unknown error occurred")}},A=k>20,R=()=>{A||a(h)};async function E(e){let t=await (0,f.lS)(`/_filter/repositories?q=${encodeURIComponent(e)}`);return t.ok?(await t.json()).repositories.map(e=>({name:e.nameWithOwner,enabled:!0,id:e.id})):[]}return(0,r.jsx)(ei.l,{onClose:t,title:"Add files",sx:{maxHeight:"500px"},renderHeader:({onClose:e})=>(0,r.jsxs)(ei.l.Header,{children:[(0,r.jsxs)("div",{className:"d-flex flex-justify-between flex-items-center px-2",children:[(0,r.jsx)(ei.l.Title,{children:"Add files"}),(0,r.jsx)(ek,{onClose:()=>e("close-button")})]}),(0,r.jsx)(ei.l.Subtitle,{children:u&&(0,r.jsx)(v.d,{repository:u,children:(0,r.jsx)(C.Ck,{children:(0,r.jsx)(w.qV,{refInfo:{name:u.refInfo.name,canEdit:!0,listCacheKey:"anything",currentOid:u.commitOID},path:"test",action:"tree",copilotAccessAllowed:!0,children:(0,r.jsx)(ew.$,{allShortcutsEnabled:!1,children:(0,r.jsx)(Y,{commitOid:u.commitOID,findFileWorkerPath:n,onItemSelected:e=>{e&&S(e)},config:{enableOverlay:!0,disableNavigation:!0,searchPlaceholder:"Search for files or folders",actionText:"Search for files or folders"}})})})})})})]}),renderFooter:()=>(0,r.jsxs)(ei.l.Footer,{children:[(0,r.jsx)("div",{className:"d-flex flex-items-center",children:A&&(0,r.jsxs)(i.A.Validation,{variant:"error",children:["A maximum of ",20," files can be added."]})}),(0,r.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[(0,r.jsx)(d.Q,{onClick:t,children:"Cancel"}),(0,r.jsx)(d.Q,{...(0,y.G)("save-resource-button"),variant:"primary",onClick:R,count:k||void 0,children:"Add files"})]})]}),children:(0,r.jsxs)("div",{className:"d-flex flex-column",children:[o&&(0,r.jsx)("span",{children:o}),!u&&(0,r.jsx)("div",{children:(0,r.jsx)(b.P,{repositoryLoader:E,selectionVariant:"single",selectAllOption:!1,currentSelection:void 0,onSelect:e=>{e&&(p([]),N(e.id))},buttonText:h[0]?.nwo||"Select repository"})}),u&&(0,r.jsx)(v.d,{repository:u,children:(0,r.jsx)(C.Ck,{children:(0,r.jsx)(w.qV,{refInfo:{name:u.refInfo.name,canEdit:!0,listCacheKey:"anything",currentOid:u.commitOID},path:"test",action:"tree",copilotAccessAllowed:!0,children:(0,r.jsx)(eS,{expandedPath:j,currentRepo:u,localFormData:h,setLocalFormData:p,onFileCountChange:I,fetchError:o,processingTime:g})})})})]})})}try{eS.displayName||(eS.displayName="FilePickerForm")}catch{}try{ek.displayName||(ek.displayName="CloseButton")}catch{}try{eI.displayName||(eI.displayName="MultiFilePicker")}catch{}var eN=a(2622);let eA={initialForm:"initialForm",editResourceForm:"editResourceForm",newResourceForm:"newResourceForm"};function eR({customCopilot:e,findFileWorkerPath:t,immersiveMode:a,updateCustomCopilot:b,ssoOrganizations:v,closeForm:C}){let[w,S]=(0,x.useState)(e?.name??""),[k,I]=(0,x.useState)(e?.description??""),[N,A]=(0,x.useState)(e?.generalInstructions??""),[R,E]=(0,x.useState)(e?.resources??[]),[F,T]=(0,x.useState)({type:"repository",id:"new-repository-resource"}),_=(0,x.useMemo)(()=>v?v.map(e=>e.login):[],[v]),[P,O]=(0,x.useState)(1),[L,$]=(0,x.useState)(eA.initialForm),[D,G]=(0,x.useState)(!1),[W,V]=(0,x.useState)(!1),M=L===eA.editResourceForm||L===eA.newResourceForm,[z,U]=(0,x.useState)({}),[q,H]=(0,x.useState)(null),Q=R.filter(e=>!e.markedForDestroy),K=e=>{A(e.target.value)},B=M&&"github_file"===F.type,[Y,X]=(0,x.useState)(!1),Z=M&&"free_text"===F.type,J=eN.W.spacesMultiFilePicker;return(0,r.jsx)(n.M,{containerWidth:"medium",children:(0,r.jsxs)(n.M.Content,{as:"div",children:[L===eA.initialForm&&(0,r.jsx)("form",{onSubmit:ea,id:`custom-copilot-form-${e?.id}`,children:(0,r.jsxs)("div",{className:"d-flex flex-column gap-3 p-3",children:[Object.keys(z).length>0&&(0,r.jsx)(m.l,{title:"Failed to save this Copilot Space",description:z.base,variant:"critical",className:"mb-2",...(0,y.G)("error-banner")}),a&&W&&(0,r.jsx)(m.l,{title:"Copilot Space saved successfully",variant:"success",className:"mb-2"}),(0,r.jsxs)(i.A,{required:!0,children:[(0,r.jsx)(i.A.Label,{required:!0,children:"Name"}),(0,r.jsx)(l.A,{block:!0,value:w,...(0,y.G)("name-input"),onChange:e=>S(e.target.value)}),z.name&&(0,r.jsxs)(i.A.Validation,{variant:"error",children:["Name ",z.name]})]}),(0,r.jsxs)(i.A,{children:[(0,r.jsx)(i.A.Label,{children:"Description"}),(0,r.jsx)(l.A,{block:!0,...(0,y.G)("description-input"),value:k,onChange:e=>{I(e.target.value)}})]}),(0,r.jsxs)(i.A,{children:[(0,r.jsx)(i.A.Label,{children:"General Instructions"}),(0,r.jsx)(eF,{text:N,promptCharLimit:2e3}),(0,r.jsx)(i.A.Caption,{children:"Describe the main responsibilities, limitations, and expertise areas of the Copilot. Include what tasks it should handle and which ones to avoid."}),(0,r.jsx)(s.Ay,{block:!0,...(0,y.G)("general-instructions-input"),value:N,onChange:e=>{K(e)}}),z.general_instructions&&(0,r.jsxs)(i.A.Validation,{variant:"error",children:["General instructions ",z.general_instructions]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{id:"resources-title",className:"f5",children:"Resources"}),(0,r.jsx)("p",{id:"resources-subtitle",className:"color-fg-muted f6",children:"Contexts, documents, or repositories that the Copilot uses to give accurate and relevant answers."}),v&&(0,r.jsx)(g.x,{protectedOrgs:_,redirectURI:()=>j.Jz}),Q.length>0&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)(h.b,{"aria-labelledby":"resources-title","aria-describedby":"resources-subtitle",data:Q,columns:[{header:"Name",rowHeader:!0,id:"id",renderCell:e=>(function(e){switch(e.type){case"repository":case"github_file":return(0,r.jsx)(eE,{row:e});case"free_text":return(0,r.jsxs)(u.A,{title:e.name.slice(0,100),maxWidth:300,className:"gap-1 d-flex",children:[(0,r.jsx)(p.FileIcon,{size:16}),e.name]});default:throw Error("Unsupported resource")}})(e)},{id:"actions",header:()=>(0,r.jsx)(o.s,{children:"Actions"}),width:"auto",renderCell:e=>(0,r.jsxs)(r.Fragment,{children:["github_file"!==e.type&&(0,r.jsx)(c.K,{"aria-label":"Edit this resource",title:"Edit this resource",icon:p.PencilIcon,variant:"invisible",onClick:()=>{$(eA.editResourceForm),T({...e})},...(0,y.G)("edit-resource-button")}),(0,r.jsx)(c.K,{"aria-label":"Delete this resource",title:"Delete this resource",icon:p.TrashIcon,variant:"invisible",onClick:()=>{E(R.map(t=>t.id===e.id?{...t,markedForDestroy:!0}:t))}})]})}]})})]}),(0,r.jsxs)("div",{className:"gap-1 d-flex",children:[(0,r.jsx)(d.Q,{size:"small",leadingVisual:p.PlusCircleIcon,...(0,y.G)("new-github-file-resource-button"),onClick:()=>{T({id:"new-github-file-resource",type:"github_file",filePath:"",repositoryId:0,nwo:""}),J?X(!0):($(eA.newResourceForm),T({id:"new-github-file-resource",type:"github_file",filePath:"",repositoryId:0,nwo:""}))},children:"Add file from a repository"}),(0,r.jsx)(d.Q,{size:"small",leadingVisual:p.PlusCircleIcon,...(0,y.G)("new-free-text-resource-button"),onClick:()=>{T({id:"new-free-text-resource",type:"free_text"}),$(eA.newResourceForm)},children:"Add text content"})]}),(0,r.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[a?(0,r.jsx)(d.Q,{onClick:()=>C?.(),children:"Close"}):(0,r.jsx)(d.Q,{as:"a",href:"/copilot",children:"Cancel"}),(0,r.jsx)(d.Q,{...(0,y.G)("save-custom-copilot-button"),type:"submit",variant:"primary",loading:D,loadingAnnouncement:"Saving Copilot Space",children:"Save"})]})]})},e?.id),Y&&J&&(0,r.jsx)(eI,{formData:[F],onCancel:et,onSave:ee,findFileWorkerPath:t}),B&&!J&&(0,r.jsx)(en,{formData:F,onCancel:et,onSave:ee,findFileWorkerPath:t}),Z&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Q,{leadingVisual:p.ArrowLeftIcon,variant:"invisible",onClick:()=>et(),children:"Back"}),(0,r.jsxs)("div",{className:"d-flex flex-column gap-3 p-3",children:[q&&(0,r.jsx)(m.l,{variant:"critical",title:q}),(0,r.jsx)("h1",{className:"f3",children:L===eA.editResourceForm?"Edit Text Content":"New Text Content"}),(0,r.jsxs)(i.A,{children:[(0,r.jsx)(i.A.Label,{children:"Name"}),(0,r.jsx)(l.A,{...(0,y.G)("free-text-name"),block:!0,value:F.name||"",onChange:e=>{T({...F,name:e.target.value})}})]}),(0,r.jsxs)(i.A,{children:[(0,r.jsx)(i.A.Label,{children:"Content"}),(0,r.jsx)(eF,{text:F.text||"",promptCharLimit:2e4}),(0,r.jsx)(s.Ay,{block:!0,...(0,y.G)("free-text-textarea"),value:F.text,onChange:e=>{T({...F,text:e.target.value})}})]}),(0,r.jsxs)("div",{className:"d-flex flex-row flex-justify-end gap-2",children:[(0,r.jsx)(d.Q,{onClick:()=>et(),children:"Cancel"}),(0,r.jsx)(d.Q,{...(0,y.G)("save-resource-button"),variant:"primary",onClick:()=>(function(e){let t=e.text,a=e.name;if(t&&a&&t.length<2e4)L===eA.editResourceForm?E(R.map(r=>r.id===e.id&&"free_text"===r.type?{...r,markedForDestroy:!1,text:t,name:a}:r)):E([...R,{id:`newly-created-free-text-resource-${P}`,markedForDestroy:!1,type:"free_text",name:a,text:t}]),et();else if(t&&t.length>=2e4){H("Text must be shorter");return}else if(void 0===a||""===a)H("Name cannot be blank");else{H("Text cannot be blank");return}})(F),children:"Save"})]})]})]})]})});function ee(e){if(0===e.length){H("Please select at least one file");return}if(!e.every(e=>e.repositoryId&&e.nwo&&e.filePath)){H("Please select a repository and file paths");return}E([...R,...e.map((e,t)=>({id:`newly-created-github-file-resource-${P+t}`,repositoryId:e.repositoryId,nwo:e.nwo,markedForDestroy:!1,filePath:e.filePath,type:"github_file"}))]),O(P+e.length),et()}function et(){$(eA.initialForm),H(null),T({type:"free_text",id:"new-free-text-resource"}),O(P+1),X(!1)}async function ea(t){if(t?.preventDefault(),D)return;G(!0);let r=e?.id?"PUT":"POST",n=e?.id?`/custom_copilots/${e.id}`:"/custom_copilots",i=j.Jz,l=await (0,f.lS)(n,{method:r,body:{custom_copilot:{name:w,description:k,general_instructions:N,resources_attributes:R.map(e=>({resource_type:e.type,id:e.databaseId,_destroy:e.markedForDestroy,metadata:function(e){switch(e.type){case"repository":return{repository_id:e.repositoryId,file_path_filters:e.filePathFilters?.split("\n").filter(e=>""!==e.trim())};case"github_file":return{repository_id:e.repositoryId,file_path:e.filePath};case"free_text":return{text:e.text,name:e.name};default:throw Error("Unsupported resource")}}(e)}))}}});if(l.ok){if(a){G(!1),V(!0);let e=await l.json();U({}),b?.(e),E(e.resources)}else window.location.href=i}else U((await l.json()).errorMessages||{"":"An unknown error occurred"}),V(!1),G(!1),V(!1)}}function eE({row:e}){return(0,r.jsxs)("span",{className:"gap-2 d-flex flex-items-end",children:[(0,r.jsx)(p.RepoIcon,{size:16}),(0,r.jsx)("span",{children:e.nwo}),(0,r.jsx)("span",{className:"fgColor-muted text-normal",children:"filePath"in e?e.filePath:e.filePathFilters})]})}function eF({text:e,promptCharLimit:t}){let a=e.length>t,n=(0,r.jsxs)(r.Fragment,{children:[e.length.toLocaleString()," / ",t.toLocaleString()," characters"]});return(0,r.jsx)(r.Fragment,{children:a?(0,r.jsx)(i.A.Validation,{variant:"error",children:n}):(0,r.jsx)(i.A.Caption,{children:n})})}try{eR.displayName||(eR.displayName="CustomCopilotForm")}catch{}try{eE.displayName||(eE.displayName="RepoRowInfo")}catch{}try{eF.displayName||(eF.displayName="CharacterCount")}catch{}},26556:(e,t,a)=>{a.d(t,{P:()=>d,w:()=>u});var r=a(74848),n=a(96540),i=a(38621),l=a(30631),s=a(55847),o=a(70170),c=a(3893);function d({currentSelection:e,repositoryLoader:t,onSelect:a,selectionVariant:d,selectAllOption:u,additionalButtonProps:m,buttonText:h=""}){let[p,f]=(0,n.useState)(""),[x,y]=(0,n.useState)([]),[g,j]=(0,n.useState)(!0),b=(0,n.useCallback)((0,o.s)(async e=>{try{let a=await t(e);y(a)}catch{}j(!1)},200),[t,y,j]);(0,n.useEffect)(()=>{j(!0),b(p)},[p,b,j]);let v=(0,n.useCallback)(e=>{"single"===d?!e[0]||e[0]._all?a(void 0):a(e[0]):a(e)},[d,a]),C=(0,n.useMemo)(()=>"multiple"===d?e||[]:e?[e]:[],[d,e]),w=(0,n.useCallback)(e=>{let t;return(e.name.length>24&&(t=`${e.name.substring(0,24)}...`),e._all)?{id:e.name,text:"All repositories",source:e,groupId:"all"}:{id:e.name,text:t||e.name,source:e,appendOnly:!1,groupId:"select",disabled:!1===e.enabled,leadingVisual:()=>e.private?(0,r.jsx)(i.RepoLockedIcon,{size:16}):(0,r.jsx)(i.RepoIcon,{size:16})}},[]),S=(0,n.useCallback)(e=>e.name,[]),k=(0,n.useMemo)(()=>{let e=[];e.push(...x);let t=C.filter(t=>e.every(e=>e.name!==t.name))||[];return e.push(...t),u&&e.push({name:"$all$",_all:!0}),e},[x,u,C]),I=h,N=i.RepoIcon;return I||("multiple"===d?I=C.length>0?`${C.length} repositor${C.length>1?"ies":"y"}`:"Select repositories":C.length>0&&C[0]?(I=C[0].name,N=C[0].private?i.RepoLockedIcon:i.RepoIcon):I=u?"All repositories":"Select a repository"),(0,r.jsx)(c.O,{renderAnchor:({"aria-labelledby":e,...t})=>(0,r.jsx)(s.Q,{leadingVisual:N,trailingAction:i.TriangleDownIcon,"aria-labelledby":` ${e}`,...t,...m,children:(0,r.jsx)(l.A,{title:I,maxWidth:195,children:I})}),placeholderText:"Repos",items:k,loading:g,groups:u?[{groupId:"all"},{groupId:"select"}]:[],selectionVariant:d,initialSelectedItems:C,onSelectionChange:v,filterItems:f,getItemKey:S,convertToItemProps:w})}function u(e){return async t=>{let a=t.trim().toLowerCase();return a?e.filter(e=>e.name.toLowerCase().includes(a)||e.name.toLowerCase().includes(a)):e}}try{d.displayName||(d.displayName="ReposSelector")}catch{}},41980:(e,t,a)=>{a.d(t,{Gy:()=>l,LB:()=>d,lm:()=>c,nn:()=>u});var r=a(74848),n=a(70170),i=a(96540);let l={small:1,medium:544,large:768,xlarge:1012,xxlarge:1280,xxxlarge:1350,xxxxlarge:1440},s=[l.xxxxlarge,l.xxxlarge,l.xxlarge,l.xlarge,l.large,l.medium,l.small],o=i.createContext({screenSize:l.small});function c(){return i.useContext(o)}function d({children:e,initialValue:t}){let a=(0,i.useSyncExternalStore)(()=>()=>{},()=>t??u(window.innerWidth),()=>t??l.small),s=(0,i.useRef)(a),[c,d]=(0,i.useState)(a),m=(0,i.useCallback)(()=>{let e=u(window.innerWidth);s.current!==e&&(s.current=e,d(e))},[]);(0,i.useEffect)(()=>{let e=new ResizeObserver((0,n.s)(m));return e.observe(document.documentElement),()=>e.disconnect()},[m]);let h=(0,i.useMemo)(()=>({screenSize:c}),[c]);return(0,r.jsx)(o.Provider,{value:h,children:e})}function u(e){for(let t of s)if(e>=t)return t;return l.small}try{o.displayName||(o.displayName="ScreenContext")}catch{}try{d.displayName||(d.displayName="ScreenSizeProvider")}catch{}},70642:(e,t,a)=>{a.d(t,{x:()=>m});var r=a(74848),n=a(38621),i=a(75177),l=a(65481),s=a(34614),o=a(89323),c=a(8338),d=a(30729),u=a(47767);function m({portalContainerName:e,protectedOrgs:t,redirectURI:a,isDisplayedInSelectPanel:o,sx:c}){let m=(0,u.zy)();if(!t||0===t.length)return null;let f=(0,r.jsx)("b",{children:t.slice(0,3).join(", ")});return 2===t.length&&(f=(0,r.jsxs)("span",{children:[(0,r.jsx)("b",{children:t[0]})," and ",(0,r.jsx)("b",{children:t[1]})]})),3===t.length&&(f=(0,r.jsxs)("span",{children:[(0,r.jsx)("b",{children:t.slice(0,2).join(", ")}),", and ",(0,r.jsx)("b",{children:t[2]})]})),(0,r.jsx)(i.A,{sx:c,"data-testid":"sso-banner",children:(0,r.jsx)(i.A,{sx:{fontSize:1},children:(0,r.jsx)("section",{"aria-label":"Single sign on information",children:(0,r.jsx)(l.A,{sx:{p:3,borderRadius:o?0:2,borderWidth:o?"1px 0":1,borderStyle:"solid",borderColor:"accent.muted",fontSize:1},children:1===t.length?(0,r.jsxs)("div",{children:[(0,r.jsx)(d.A,{icon:n.ShieldLockIcon}),(0,r.jsx)(s.A,{inline:!0,href:`/orgs/${t[0]}/sso?return_to=${p({location:m,redirectURI:a})}`,children:"Single sign-on"}),"\xa0to see results in the ",(0,r.jsx)("b",{children:t[0]})," organization."]}):(0,r.jsxs)(i.A,{sx:{display:"flex",alignItems:"baseline",gap:2,"& svg":{marginRight:"0 !important"}},children:[(0,r.jsx)(d.A,{sx:{position:"relative",top:"3px"},icon:n.ShieldLockIcon}),(0,r.jsxs)(i.A,{sx:{display:"flex",alignItems:"baseline",gap:[0,2],flexWrap:["wrap","nowrap"],flexGrow:1},children:[(0,r.jsxs)(i.A,{as:"p",sx:{marginBottom:0},children:["Single sign on to see results in the ",f," ",t.length>3?`and ${t.length-3} other `:"",t.length>1?"organizations":"organization","."]}),(0,r.jsx)("div",{children:(0,r.jsx)(h,{portalContainerName:e,protectedOrgs:t,redirectURI:a})})]})]})})})})})}function h({portalContainerName:e,protectedOrgs:t,redirectURI:a}){let n=(0,u.zy)();return(0,r.jsxs)(o.W,{children:[(0,r.jsx)(o.W.Button,{size:"small",children:"Select an organization"}),(0,r.jsx)(o.W.Overlay,{portalContainerName:e,children:(0,r.jsx)(c.l,{children:t.map(e=>(0,r.jsx)(c.l.Item,{onSelect:()=>window.location.href=`/orgs/${e}/sso?return_to=${p({location:n,redirectURI:a})}`,children:e},`org-${e}`))})})]})}function p({location:e,redirectURI:t}){return encodeURIComponent(t?t(e):e.pathname+e.search+e.hash)}try{m.displayName||(m.displayName="SingleSignOnBanner")}catch{}try{h.displayName||(h.displayName="SingleSignOnButton")}catch{}}}]);
//# sourceMappingURL=ui_packages_document-metadata_document-metadata_ts-ui_packages_custom-copilots_components_Cus-bfb1df-6400d6dca6e5.js.map